---
title: Dynamic Computation offloading for mobile-Edge Computing with Energy Havesting Devices
date: 2022-5-15
tags:
- MEC
- computation offload
- math
categories:
- Paper
---
# 能量收集设备中移动边缘计算的动态计算卸载

## _Abstract_
MEC是一种为了满足日渐增长的移动应用计算需求的方法。通过卸载一些计算集中的工作到MEC服务器，计算的质量比如执行延迟，能够显著提升。然而，因为受限于电池容量，计算可能因设备没电而终止。为了提供满意的通信服务的同时，还能够实现绿色通信，通过能量收集来获取可再生能源就很重要了。本文中，我们将研究EH设备构成的绿色MEC系统并开发高效的计算卸载策略。执行损耗作为执行指标，包括执行延迟和任务失败。一个低复杂度的LODCO（基于Lyapunov优化的动态计算卸载）在线算法被用来处理卸载决定，移动执行的CPU周期频率以及计算卸载的传输功率。这个算法的优势是只取决于实时信息，而不需要考虑计算任务需求，无线信道，EH过程的分布信息。这个算法执行的时候只需要在每个时隙解决一个决定性问题，因为可以在闭式最优解，或者运用二分查找求解，除此之外，通过严格分析可以表明这个算法是渐进最优的。样值仿真可以验证理论的真实性以及验证提出算法的有效性。

## _Introduction_
随着移动设备兴起，比如手机，笔记本等，这加速了IOT产业的兴起，触发了移动应用的革新。随着移动设备支持摄像头等传感设备，一些新应用也产生了：导航，面部识别等等。然而，由于设别计算能力和应用需求的算力的矛盾，这些移动通信应用的发展受到影响。

MEC在接入网中提供了云计算能力，为卸载移动端沉重的计算负担提供了方案。在传统的云计算系统中，使用远端的云服务器（亚马逊网页服务，谷歌云平台，Microsoft Azure等等），这带来了巨大的延时。相反，MEC可以减少延时，避免拥塞，延长移动端设备因为减少了计算任务。所以最近有许多工业界和学术界的研究。

不幸的是：虽然计算卸载能有效的缓解计算压力，但是这种方法受限于移动设备的电量。EH（能量收集）是这个问题的一个解决方案，它能够捕捉丰富的可回收资源，比如太阳辐射，风，以及人类运动，这样来持续工作。

通过将EH引入MEC来实现令人满意和可持续的服务。但是也带来的了挑战：怎么考虑EH设备组成MEC的计算卸载策略。

_**Related Work**_：

近年来，MEC的计算卸载被广泛研究。为了提升电池寿命，提高计算性能，提出了MAUI，ThinkAir等编码卸载框架。然而因为数据卸载需要数据传输，这样的卸载效率十分依赖无线信道属性。这就要求一些算法能够结合无线信道环境来进行计算卸载。随机控制算法就被提了出来，它可以适应时变无线信道，因为它的卸载计算软件能根据无线信道来变化。对于飞秒计算云系统，云服务器由一系列飞秒接入点组成，将发射功率，预编码和计算卸载分配共同考虑。除此之外，对于多用户移动云计算系统也提出了博弈论分散计算负载算法。然而这些工作假定了移动端的CPU处理速度是不变的，这个导致算法是不节能的，因为能耗与CPU处理频率成线性正比关系。应用DVFS（动态电压频率调节）技术，使得通过控制电压控制CPU频率，能够在严格的DDL限制下的实现本地计算能量消耗最小化。除此之外，还提出了多蜂窝MIMO云计算系统中通信和计算资源的联合分配。最新的，用lyapunov优化算法来对混合型任务的能量与延迟tradeoff进行优化，包括卸载策略，任务分配，CPU时钟速度，可选的网络接口。

EH技术被引入通信来实现自我可持续绿色通信。如果有非因果信息（包括信道方面信息，能量方面信息），那么就可以利用方向性注水定理实现点对点最大化的能量收集信道的最大吞吐率。接着研究了EH网络因果辅助信息。带有可再生能源的蜂窝网络也有被研究。用HES（混合能量供应）技术能使得OFDMA系统中能量效率达到最大。还可以加sleep模式进一步降低功耗，也有学者提出了基于Lyapunov优化来分配站点以及功率控制。

具有EH设备的MEC网络的设计原则和EH通信系统或电池供电的MEC网络是不同的。一方面，与EH通信系统相比：计算卸载策略需要做联合决策，这让其更加难了，也就是说是否卸载任务、移动端CPU计算频率、卸载时传输的策略。另一方面，跟电池供电的MEC网络相比，设计目标已经从最小化能量消耗到当收集的能量免费获得时的计算性能最优化。除此之外，还需要能量方面的信息，时间相关的电量波动带来了新挑战。

_**Contribution**_:

本文中，我们将会探究带有EH设备的MEC系统，并提出一个高效的在线算法。本文的主要贡献如下：
1、我们考虑EH设备是被MEC服务器服务的，计算任务可以本地算，也可以放到MEC服务器进行云计算。
我们将执行延迟和任务失败作为性能指标。同时DVFS和功率控制被用来优化移动执行处理以及计算卸载的数据传输。
2、提出了执行消耗最小化问题：这是一个很难处理的高阶马尔可夫决策问题，假设条件是因果辅助信息，提出了在线的基于Lyapunov优化动态卸载算法（LODCO）。在每一个时隙，系统的操作（包括卸载决定，移动端CPU频率，计算卸载的传输功率）仅仅取决于确定性最优化问题的最优解，这个解可以通过闭式解或者二分法查找。
3、我们确定了在一定电能水平的情况下预定的CPU执行周期（传输功率）有非递减性质，也就是说更多的能耗更低的延迟。LODCO算法的性能也讨论了。表明提出的算法能够通过调节一个二元组来实现逐渐逼近EMC问题的最优性能。除此之外，算法不需要随机过程的静态信息包括计算任务的需求，无线信道，EH过程。这使得算法能够在位置环境中应用。
4、用仿真验证了理论分析，特别是LODCO的渐进逼近最优的性质。除此之外，还对比了LODCO与三基准算法证明了它的高效性。这表明LODCO算法不仅仅在执行损耗方面有巨大改进，还提高减少了任务的失败。

本文组织如下：第二部分我们将介绍系统模型，第三部分提出ECM问题的模型，第四部分提出LODCO算法，第五部分性能分析，第六部分仿真结果，第七部分总结。

## _System model_
本部分将介绍本文的系统模型，也就是具有EH设备的MEC系统。计算模型和能量收集模型都会被讨论。

_**Mobile-edge Computing System with EH Devices**_
<a href="https://sm.ms/image/kFwuG5VxS1ciR3o" target="_blank"><img src="https://s2.loli.net/2022/05/18/kFwuG5VxS1ciR3o.jpg" ></a>
如上图，我们考虑一个MEC服务器和一个终端的MEC系统。终端上有一个EH模块，可以完全为终端供电。MEC服务器是一个电信运营商的小型服务器，终端可以通过无线信道对它接入。移动设备是跟MEC服务器中的系统级克隆相关联的，叫做云端克隆，可以运行虚拟机并代表移动设备执行任务。通过向服务器卸载计算，计算体验有了很大提升。
假设分了时隙，用$\tau$表征时隙长度，$\Tau = \{0,1,...\}$表征时隙下标。假设无线信道是独立同分布的衰落，在每个时隙衰落可以看作是静态的，不同时隙不同。在第t个时隙，信道增益可以用$h^t$来表示，$h^t \sim F_H(x)$,$F_H(x)$是$h^t$的分布函数。系统中的标记如下：
<a href="https://sm.ms/image/RSChd7feK4VXEWt" target="_blank"><img src="https://s2.loli.net/2022/05/18/RSChd7feK4VXEWt.jpg" ></a>

_**Computation Model**_
我们用$A(L,\tau_d)$来表示一个计算任务，$L (bits)$表示任务的大小，$\tau_d$表示执行的DDL。移动端的上的计算需求可以被建模为独立同分布的伯努利过程。在一个时隙开始时，计算任务$A(L,\tau_d)$以p的概率被需要。用$\zeta^t = 1$表明在第t个时隙需要一个任务，也就是说$P(\zeta^t = 1) = 1-P(\zeta^t = 0) = p$，我们关注那些时延敏感应用，DDL时间需要小于一个时隙的长度，也就是说$\tau_d \le \tau$，同时假设没有buffer来进行缓冲。

每个计算任务都可以选择在本地计算，或者发到服务器进行计算。也可能两种选择都不行，比如设备没电了，这时，计算任务就会被丢弃。用$I_j^t \in \{0,1\}$来表明计算模式，其中$j = \{m,s,d\}$，$I^t_m = 1$表明在t时隙任务在移动端(M)执行，$I^t_s$表明在t时隙在服务器（S）执行，$I^t_d$表明t时隙任务被丢弃（D）。所以有：
$$ I^t_m+I^t_s+I^t_d=1,t\in\Tau	$$

**本地执行模型**:

用X来表示执行1bit数据需要的CPU周期数，这个根据不同的应用不一样，可以通过离线的测量获得。$W = LX$就是执行$A(L,\tau_d)$需要的时间。执行第$w$个CPU周期的频率可以用$f^t_w$来表示，其中$w = 1,...,W$。这个调整可以通过DVFS技术，调整电压即可调整频率。结果，在第t时隙的计算延时可以计算为：
$$D^t_{mobile}=\sum\limits^{W}_{w=1}(f^t_w)^{-1}$$
相应的本地执行消耗的能量可以表示为：
$$E^t_{mobile}=\kappa\sum\limits^W_{w=1}(f^t_w)^2$$
其中$\kappa$与芯片结构相关，表示有效开关电容。除此之外，我们假设$f^{max}_{CPU}$是CPU的最大频率。

**服务器执行**:

为了将计算卸载到服务器，应该要把$A(L.\tau_d)$的数据传给服务器。我们假设EMC服务器有足够的算力，所以能忽略它的计算延时。进一步假设计算是输出数据量很少，所以回传的时间也可以忽略。有$p^t$表示传输功率，最大的传输功率表示为$p^{max}_{tx}$。根据香农公式，在第t时隙内可以传输的速率为$r(h^t,p^t) = Wlog_2(1+\frac{h^tp^t}{\sigma})$，其中$W$是系统带宽，$\sigma$是接收机噪声功率。因此虽然是送到服务器计算，但是延时仅仅是为了传输输入数据的时间。
$$D^t_{server}=\frac{L}{r(h^t,p^t)}$$
能量消耗可以表示为:
$$E^t_{server}=p^t\cdot D^t_{server}=p^t\cdot\frac{L}{r(h^t,p^t)}$$

**能量收集模型**：

将EH过程建模为连续能量包到达的过程。也就是说$E^t_H$单位的能量在第t时隙开始时到达。我们假设不同时隙到达的$E^t_H$服从独立同分布，有最大值$E^{max}_H$。尽管独立同分布很简单，但是表征了可再生能源的随机性和可再生性。在每个时隙，到达的能量满足：
$$0\le{e^t}\le{E^t_H},t\in\Tau$$
$e^t$将会被收集并存储在电池中，可以被下一个时刻的本地计算和计算卸载使用。我们先假设移动端的电池容量是足够的。接着通过选择不同的$e^t$，我们可以证明在我们提出的这个算法下，电池的能量是有一个确定的上界的，一个有限容量的电池就足够了。更重要的是，$e^t$是一个辅助我们推导分析我们算法的优化变量。用$B^t$来表示第t个时隙开始时电池的电量。一般情况下，我们假设$B^0 = 0$，同时$B^t < +\infty$。本文中能量消耗仅仅考虑本地计算的消耗和上传数据的消耗。用$\mathcal E(I^t,f^t,p^t)$表示第t时隙的能量消耗，与选择在哪儿计算，CPU的频率，传输功率都相关，可以表示为：
$$\mathcal E(I^t,f^t,p^t)=I^t_mE^t_{mobile}+I^t_sE^t_{server}$$
受限于：
$$\mathcal E(I^t,f^t,p^t)\le{B^t}\le{+\infty},t\in\Tau$$
因此剩余的能量可以表示为:
$$B^{t+1}=B^t-\mathcal E(I^t,f^t,p^t)+e^t,t\in\Tau$$

因为移动端有EH模块，计算卸载策略比传统的电池供电设备的计算卸载问题更加的复杂。特别是，能量辅助信息，信道辅助信息都要掌握。变化的电量使得不同时隙之间的决策相互耦合。因此，卸载策略需要兼顾当前时刻的性能，也要兼顾后续时刻的性能。

## _Problem formulation_

这部分我们将先介绍性能指标：执行花费。接着提出了最小化执行花费的问题，并说明了这个问题的难度。

**执行花费最小化问题**：

执行延迟是用户体验的重要指标。在我们的决策中，将这一指标用于优化计算卸载策略。然而由于EH的突发性和间断性，计算任务可能被丢弃。为了将这一部分纳入考虑范围，我们用一个单位的花费来表示任务丢弃。所以我们可以将执行损耗定义如下：
$$cost^t=\mathcal D(I^t,f^t,p^t)+\phi\cdot\bold 1(\zeta^t=1,I^t_d=1)$$
$\phi$是任务丢弃的加权系数。$1(\cdot)$是指示函数，$D(I^t,f^t,p^t)$表示如下：
$$D(I^t,f^t,p^t)=\bold1(\zeta^t=1)\cdot(I^t_mD^t_{mobile}+I^t_sD^t_{server})$$
一般而言，我们假设延时比任务丢弃更好。即$\tau_d \le \phi$
如果要完成执行，那么延时要比DDL小，即
$$\mathcal D(I^t,f^t,p^t)\le{\tau_d},t\in\Tau$$
因此，ECM问题可以被表达为：
$$P_1: \min\limits_{I^t,f^t,p^t,e^t}\lim\limits_{T\rightarrow\infty}\frac{1}{T}\mathbb E \bigg[\sum\limits^{T-1}_{t=0}cost^t\bigg]$$
$$ s.t.    I^t_m+I^t_s+I^t_d=1,t\in\Tau $$
$$0\le{e^t}\le{E^t_H},t\in\Tau$$
$$\mathcal E(I^t,f^t,p^t)\le{B^t}\le{+\infty},t\in\Tau$$
$$D(I^t,f^t,p^t)\le{\tau_d},t\in\Tau$$
$$I^t_m+I^t_s\le\zeta^t,t\in\Tau$$
$$\mathcal E(I^t,f^t,p^t)\le E_{max},t\in\Tau$$
$$0\le p^t\le p^{max}_{tx}\cdot \bold1(I^t_s=1),t\in\Tau$$
$$0\le f^t_w \le f^{CPU}_{max}\cdot\bold1(I^t_m=1),w=1,\ldots,W,t\in\Tau$$
$$I^t_m,I^t_s,I^t_d\in\{0,1\},t\in\Tau$$

**问题分析**：
在MEC系统中系统的状态是由：任务需求，可收集的能量，电池能量水平，以及信道状态组成；系统行动是能量收集和计算卸载决策，包括设定的CPU时钟周期和分配的传输功率。行动的决定之和当前状态相关和过去的状态无关。除此之外，目标是长期的执行损耗最小。因此这是一个马尔可夫决策过程。理论上，这个问题应该由通过标准的MDP算法来解决，比如：相对值迭代算法和线性规划重构算法。然而这两种算法都是用有限状态来表征系统，离散化可执行集。例如，用20个状态离散信道，20个状态离散电量，5个状态离散收集的能量……这样就有了有限多种的系统状态。应用相对值迭代算法将会花很长时间收敛，因为有大量的可行集。应用线性规划重构算法需要解一个超级多变量的线性规划问题，是几乎不能实现的。除此之外，通过马尔科夫决策过程很难获得深入的解，因为是基于数值的。除此之外，量化会造成性能下降，而且需要大量的内存存储最优决策。

下一部分，我们提出了Lyapunov优化动态计算卸载算法，它有如下性质：

1、不需要量化，在每个时隙的决策是很简单的，不需要内存来存储最优策略。
2、不需要先验信息
3、算法的性能被一个二元组控制，通过调整这写参数可以任意的逼近最优解。
4、有一个电池容量上界，可以指导实际的生产活动。


## _Dynamic Computation Offloading:the LODCO algorithm_

在这部分，我们将用LODCO算法来解决问题。首先我们将说明最优的CPU频率具有的特征，这可以帮助我们简化问题。为了利用lyapunov优化，我们引入了修改的ECM问题来辅助算法设计。接着说明LODCO算法，最后我们说明解是渐进最优的。

**LODCO算法**：
我们首先证明在单个计算任务中的W个CPU周期中最优的CPU频率应该是相同的，就像下面提到的引理一样。

引理1：如果一个计算任务在第t个时隙被决定在本地执行那么，最优的CPU计算频率应该是相同的。即$f^t_w = f^t,w = 1,...,W$
证明：可以通过矛盾证明，这里为了简洁省略了。

引理1中CPU周期的性质表明我们只需要优化一个标量$f^t$而不是一个W维向量$\mathbf{f^t}$。由于$\mathcal E(I^t,f^t,p^t)\le{B^t}\le{+\infty},t\in\Tau$的限制，导致不同时隙的系统的决策相互耦合。这是设计EH系统常见的困难。我们发现通过引入电池的非零下界$E_{min}$，这种耦合就被消除了，所以我们的问题可以被优化为：
$$P_2: \min\limits_{I^t,f^t,p^t,e^t}\lim\limits_{T\rightarrow\infty}\frac{1}{T}\mathbb E \bigg[\sum\limits^{T-1}_{t=0}cost^t\bigg]$$
$$ s.t.    I^t_m+I^t_s+I^t_d=1,t\in\Tau $$
$$0\le{e^t}\le{E^t_H},t\in\Tau$$
$$\mathcal E(I^t,f^t,p^t)\le{B^t}\le{+\infty},t\in\Tau$$
$$D(I^t,f^t,p^t)\le{\tau_d},t\in\Tau$$
$$I^t_m+I^t_s\le\zeta^t,t\in\Tau$$
$$\mathcal E(I^t,f^t,p^t)\le E_{max},t\in\Tau$$
$$0\le p^t\le p^{max}_{tx}\cdot \bold1(I^t_s=1),t\in\Tau$$
$$0\le f^t_w \le f^{CPU}_{max}\cdot\bold1(I^t_m=1),w=1,\ldots,W,t\in\Tau$$
$$I^t_m,I^t_s,I^t_d\in\{0,1\},t\in\Tau$$
$$\mathcal E(I^t,f^t,p^t)\in{0}\bigcup[E_{min},E_{max}],t\in\Tau$$

与问题1相比，$f^t$是标量，使得移动端的延时$D^t_{mobile} = W \cdot \frac{1}{f^t}$，能量为$E^t_{mobile} = W_{\kappa} \cdot (f^t)^2$。标志问题$P_1$的最小延时开销为$ EC^*_{P_1} $ ，问题 $ P_2 $ 的最小延时开销为 $ EC^*_{P_2} $。下面的命题表明了这两个解之间的关系，这将帮助我们显示提出算法的逐渐优化特性。

命题1：问题2的最佳值比问题1的大，但是比问题1的最佳值加上一个正数（$v(E_{min})$）小。$EC^*_{P_1} \le EC^*_{P_2} \le EC^*_{P_1}+v(E_{min})$，其中$v(E_{min}) = \rho[\phi (1-F_H( \eta ))+1_{E_{min} \ge E^{\tau_d}_{min}} \cdot (\phi - \tau_{E_{min}})]$，其中$ \eta = (2^{\frac{L}{\tau_{d^w}}}-1) \sigma \tau_d E^{-1}_{min} ,E^{\tau_d}_{min} = \kappa W^3 \tau^{-2}_d, \tau_{E_{min}} = \kappa^{\frac{1}{2}}W^{\frac{3}{2}}E^{-\frac{1}{2}}_{min}$

证明：首先由于$P_2$比$P_1$的约束更多，所以$EC^*_{P_1} \le EC^*_{P_2}$。下面我们来推导另一边的不等式：i)如果在t时刻到达的任务消耗的能量小于$E_{min}$那么在$P_2$中就会被丢弃。ii)如果任务需要花费的能量在$[E_{min},E_{max}]$区间内，我们可以发现$P_2$的解跟$P_1$的相同。iii)我们收集能量的多少可以决定为$max\{B^t_{P_1}-\mathcal E(I^t_{P_1},f^t_{P_1},p^t_{P_1})+e^t_{P_1}-B^t_{P_2}+\mathcal E(I^t_{P_2},f^t_{P_2},p^t_{P_2}),0\}$显然我们可以发现$P_2$剩下的能量总比$P_1$多。如果我们将$E_{min}$设定得比$E^{\tau_d}_{min}$大，其中$E^{\tau_d}_{min} = \kappa W^3\tau_d^{-2}$是在本地执行在不超时的情况下最小的能量花费，如果有一个t时隙需要花费的能量小于最小能量$E_{min}$，那么最糟糕的情况下增加的花费就是$(\phi-\tau_{E_{min}})$。其中$\tau_{E_{min}}=\kappa^{\frac{1}{2}} W^\frac{3}{2}E_{min}^{-\frac{1}{2}}$；否则如果将$E_{min}$设置得比$E^{\tau_d}_{min}$还小的话是不行的，因为不满足时间要求。除此之外，在能量低于$E_min$的情况下，向服务器卸载成功的概率不会大于$P\{\omega\tau_d log_2(1+\frac{h^tp^t}{\sigma}) \ge L\} = 1-F_H(\eta)$，其中$\eta \triangleq (2^{\frac{L}{w\tau_d}}-1)\tau_d\sigma E^{-1}_{min}$,最糟糕的情况是比原来的延时多$\phi$，因为$cost^t_{P_1} \ge 0$。通过整合可以得到上述结果。

